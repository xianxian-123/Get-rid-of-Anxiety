<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°éŠæˆ²</title>
    <style>
        /* --- åŸºç¤æ’ç‰ˆèˆ‡å®¹å™¨æ¨£å¼ --- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f7f9fc;
            padding: 20px;
            color: #333;
            text-align: center;
        }

        #input-area { max-width: 800px; margin: 20px auto; padding: 25px; background-color: #ffffff; border-radius: 15px; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1); }
        .subject-input-row { display: flex; align-items: center; margin-bottom: 15px; padding: 10px; border-bottom: 1px solid #eee; }
        .subject-input-row label { font-weight: bold; color: #5a7d7d; width: 80px; text-align: left; margin-right: 15px; }
        input[type="text"] { padding: 8px; border: 1px solid #ddd; border-radius: 5px; flex-grow: 1; margin-right: 15px; }
        .cta-button { padding: 8px 15px; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; transition: background-color 0.3s; }
        .cta-button:hover { opacity: 0.9; }

        /* å½ˆè—¥åº«æ¨£å¼ */
        #ammo-container {
            min-height: 150px; border: 3px dashed #a3c1e8; border-radius: 10px; padding: 20px; margin-top: 30px; max-width: 800px; margin-left: auto; margin-right: auto; display: flex; flex-wrap: wrap; gap: 15px; align-content: flex-start; text-align: left;
            position: relative;
        }

        /* --- ç‚¸å½ˆæ¨£å¼ --- */
        .effort-bomb {
            width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 10px; font-weight: bold; cursor: move; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); position: relative; 
            transition: transform 0.2s; overflow: hidden; text-align: center; 
        }
        .effort-bomb.dragging { position: absolute; z-index: 1000; }
        .effort-bomb::before { content: 'ğŸ”¥'; position: absolute; top: -10px; right: 25px; font-size: 15px; line-height: 1; }
        .bomb-text { padding: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 90%; }
        /* ç‚¸å½ˆé¡è‰² */
        .bomb-chinese { background-color: #ff6b6b; } .bomb-english { background-color: #4CAF50; } .bomb-biology { background-color: #ffc300; } .bomb-chemistry { background-color: #00bcd4; } .bomb-physics { background-color: #9c27b0; } 
        
        /* è²¶ä½ç›®æ¨™æˆ°é¬¥å€æ¨£å¼ */
        #battle-area {
            max-width: 800px; min-height: 250px; margin: 30px auto; padding: 20px; border: 3px solid #ffcccc; border-radius: 10px; background-color: #fff0f0; position: relative; text-align: center;
        }

        /* --- ç›®æ¨™æ¨£å¼èª¿æ•´ç‚ºæ–‡å­—é¡¯ç¤º --- */
        .negativity-target {
            width: 150px;
            height: 150px;
            margin: 20px auto;
            position: absolute;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            border: 3px solid #ff4757;
            border-radius: 10px; /* å¢åŠ åœ“è§’ */
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            overflow: hidden; 
            
            /* æ–‡å­—æ¨£å¼ */
            background-color: #ffeaea; /* è¼•å¾®çš„èƒŒæ™¯è‰² */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #d63031;
            padding: 10px;
            text-align: center;
        }

        .negativity-target.hit-ready {
            border-color: #4CAF50;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.8);
            background-color: #e8f5e9; /* æº–å‚™æ“Šä¸­æ™‚è®Šè‰² */
        }
            
        /* --- æ–‡å­—ç¢è£‚å‹•ç•«ï¼šä½¿ç”¨ç¸®æ”¾å’Œé€æ˜åº¦æ¨¡æ“¬æ–‡å­—æ¶ˆæ•£ --- */
        @keyframes shatter {
            0% { 
                transform: scale(1) rotate(0deg); 
                opacity: 1; 
            }
            100% { 
                /* è®“æ–‡å­—ç¸®å°ä¸¦å¿«é€Ÿæ·¡å‡º */
                transform: scale(0.1) rotate(-10deg); 
                opacity: 0; 
                filter: blur(5px);
            }
        }
            
        .detonate-animation {
            /* ç›´æ¥å°ç›®æ¨™å®¹å™¨æ‡‰ç”¨å‹•ç•« */
            animation: shatter 0.5s ease-out forwards; 
        }

    </style>
</head>
<body>

    <header>
        <h1>ğŸ“šä»Šå¤©åšäº†å“ªäº›?<h1>
        <p>æŠ•å…¥çš„åŠªåŠ›ä¾†æ‰“æ“Šä½ è¨å­çš„<p>
    </header>

    <section id="input-area">
        <h2>ğŸ“ ç´€éŒ„ä½ çš„åŠªåŠ›</h2>

        <div class="subject-input-row">
            <label for="effort-chinese">åœ‹æ–‡</label>
            <input type="text" id="effort-chinese" placeholder="çœ‹å¹¾åˆ†é˜ä¹Ÿç®—å–”">
            <button class="cta-button bomb-chinese" onclick="generateBomb('chinese')">ç”Ÿæˆç‚¸å½ˆ</button>
        </div>
        <div class="subject-input-row">
            <label for="effort-english">è‹±æ–‡</label>
            <input type="text" id="effort-english" placeholder="èƒŒä¸€å€‹ç®—ä¸€å€‹">
            <button class="cta-button bomb-english" onclick="generateBomb('english')">ç”Ÿæˆç‚¸å½ˆ</button>
        </div>
        <div class="subject-input-row">
            <label for="effort-biology">ç”Ÿç‰©</label>
            <input type="text" id="effort-biology" placeholder="æˆ‘çŸ¥é“ä½ é€™å€‹æœ€å¼·äº†">
            <button class="cta-button bomb-biology" onclick="generateBomb('biology')">ç”Ÿæˆç‚¸å½ˆ</button>
        </div>
        <div class="subject-input-row">
            <label for="effort-chemistry">åŒ–å­¸</label>
            <input type="text" id="effort-chemistry" placeholder="æ²’äº‹å¤šç®—å°±ç†Ÿäº†">
            <button class="cta-button bomb-chemistry" onclick="generateBomb('chemistry')">ç”Ÿæˆç‚¸å½ˆ</button>
        </div>
        <div class="subject-input-row">
            <label for="effort-physics">ç‰©ç†</label>
            <input type="text" id="effort-physics" placeholder="æœ‰è§€å¿µå°±å¾ˆæ£’äº†">
            <button class="cta-button bomb-physics" onclick="generateBomb('physics')">ç”Ÿæˆç‚¸å½ˆ</button>
        </div>
    </section>

    <section>
        <h2>ğŸ’£ å½ˆè—¥åº« (æ‹–æ›³é€™è£¡çš„ç‚¸å½ˆä¾†æ‰“ä¸‹é¢çš„å£å£</h2>
        <div id="ammo-container">
            <p style="color: #666; width: 100%; text-align: center;" id="placeholder-text">ç•¶ä½ è¼¸å…¥åŠªåŠ›æœƒæœ‰ç‚¸å½ˆ</p>
        </div>
    </section>

    <section id="battle-area">
        <h2>ğŸš¨ è‡­è‡­å£å£ç‹å…«è›‹ğŸš¨ <h2>
        <p>è«‹å°‡ä¸Šæ–¹çš„åŠªåŠ›ç‚¸å½ˆæ‹–æ›³åˆ°é€™å€‹ç›®æ¨™ä¸Šï¼Œæ“Šç¢å‚·äººçš„è©±<p>
            
        <div id="negativityTarget" class="negativity-target">
            </div>
            
        <div id="feedback" style="margin-top: 190px; color: green; font-weight: bold;"></div>
    </section>

    <script>
        const ammoContainer = document.getElementById('ammo-container');
        const placeholderText = document.getElementById('placeholder-text');
        const negativityTarget = document.getElementById('negativityTarget');
        const feedbackElement = document.getElementById('feedback');

        // --- æ ¸å¿ƒæ”¹å‹•ï¼šéš¨æ©Ÿè² é¢æ–‡å­—é™£åˆ— ---
        const negativeTargetTexts = [
            "é‚„ä¸éŒ¯å˜›ï¼Œå°ä½ ä¾†èªª",      
            "è›¤ä½ éäº†?",     
            "å–”~ä½ å¯ä»¥è€ƒæˆé€™æ¨£å–”?",   
            "ä¸éŒ¯å˜›",  
            "ä»–æ ¹æœ¬åªæ˜¯ç„¡èŠæ‰è·Ÿä½ è«‡",     
            "ä½ å«æˆ‘è¤‡ç¿’æˆ‘æ‰è¤‡ç¿’çµæœä½ è€ƒé‚£æ¨£",
            "æˆ‘è®€çš„é‚„ä¸å¤ ",
            "ã„šã„šã„šå¿«æ²’æ™‚é–“äº†"
        ];

        // ----------------------------------------------------
        // æ ¸å¿ƒé‚è¼¯ä¸€ï¼šç‚¸å½ˆç”Ÿæˆ (ä¿æŒä¸è®Š)
        // ----------------------------------------------------

        function generateBomb(subject) {
            const inputElement = document.getElementById(`effort-${subject}`);
            const effortText = inputElement.value.trim();
            
            if (effortText === "") {
                alert(`è«‹è¼¸å…¥ä½ åœ¨${subject}ä¸Šçš„åŠªåŠ›å…§å®¹ï¼`);
                return;
            }

            if (placeholderText) {
                placeholderText.style.display = 'none';
            }

            const bomb = document.createElement('div');
            bomb.className = `effort-bomb bomb-${subject}`;  
            bomb.setAttribute('data-subject', subject);
            bomb.setAttribute('data-effort', effortText);   

            const bombText = document.createElement('div');
            bombText.className = 'bomb-text';
            bombText.textContent = effortText;
            bomb.appendChild(bombText);
            
            ammoContainer.appendChild(bomb);
            makeDraggable(bomb);
            inputElement.value = '';

            feedbackElement.textContent = `ğŸ‰ ${subject.toUpperCase()} åŠªåŠ›æˆåŠŸå„²å­˜`;
        }

       // ----------------------------------------------------
// æ ¸å¿ƒé‚è¼¯äºŒï¼šæ‹–æ›³åŠŸèƒ½ (åŒæ™‚æ”¯æŒæ»‘é¼ å’Œè§¸æ§)
// ----------------------------------------------------

function makeDraggable(element) {
    // å›ºå®šå°‡åç§»é‡è¨­å®šç‚ºç‚¸å½ˆå¯¬åº¦/é«˜åº¦çš„ä¸€åŠ (80px / 2 = 40px)
    const CENTER_OFFSET_X = 40; 
    const CENTER_OFFSET_Y = 40; 

    // 1. ç¶å®šæ»‘é¼ äº‹ä»¶
    element.onmousedown = startDrag;

    // 2. ç¶å®šè§¸æ§äº‹ä»¶
    element.addEventListener('touchstart', startDrag, { passive: false }); // { passive: false } å…è¨±æˆ‘å€‘ä½¿ç”¨ preventDefault

    // çµ±ä¸€çš„é–‹å§‹æ‹–æ›³è™•ç†å‡½æ•¸
    function startDrag(e) {
        e.preventDefault(); // é˜»æ­¢ç€è¦½å™¨çš„é è¨­è¡Œç‚ºï¼ˆä¾‹å¦‚æ‰‹æ©Ÿä¸Šçš„æ»¾å‹•æˆ–ç¸®æ”¾ï¼‰
        
        // å–å¾—ç•¶å‰äº‹ä»¶çš„åº§æ¨™ (å¦‚æœæ˜¯è§¸æ§ï¼Œå–ç¬¬ä¸€å€‹è§¸æ§é»)
        const clientX = e.type.startsWith('touch') ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.startsWith('touch') ? e.touches[0].clientY : e.clientY;
        
        // 1. åˆ‡æ›åˆ°çµ•å°å®šä½ (é–‹å§‹æ‹–æ›³)
        element.classList.add('dragging'); 
        
        // 2. æ ¹æ“šç•¶å‰é¼ æ¨™/è§¸æ§ä½ç½®æ¸›å»ä¸­å¿ƒåç§»é‡ï¼Œè¨­å®šç‚¸å½ˆçš„èµ·å§‹ä½ç½®
        element.style.left = (clientX - CENTER_OFFSET_X) + 'px';
        element.style.top = (clientY - CENTER_OFFSET_Y) + 'px';

        // ç¶å®šç§»å‹•å’ŒçµæŸäº‹ä»¶
        if (e.type.startsWith('touch')) {
            document.addEventListener('touchmove', elementDrag, { passive: false });
            document.addEventListener('touchend', closeDragElement);
        } else {
            document.onmouseup = closeDragElement;
            document.onmousemove = elementDrag;
        }
    }

    // çµ±ä¸€çš„ç§»å‹•è™•ç†å‡½æ•¸
    function elementDrag(e) {
        e.preventDefault(); // é˜»æ­¢æ‹–æ›³æ™‚çš„ç€è¦½å™¨é è¨­æ»¾å‹•è¡Œç‚º
        
        // å–å¾—ç•¶å‰äº‹ä»¶çš„åº§æ¨™
        const clientX = e.type.startsWith('touch') ? e.touches[0].clientX : e.clientX;
        const clientY = e.type.startsWith('touch') ? e.touches[0].clientY : e.clientY;
        
        // ä½¿ç”¨ä¸­å¿ƒåç§»é‡ä¾†å®šä½ç‚¸å½ˆçš„å·¦ä¸Šè§’ï¼Œå¯¦ç¾æ»‘é¼ /è§¸æ§å°æº–ä¸­å¿ƒ
        element.style.top = (clientY - CENTER_OFFSET_Y) + "px";
        element.style.left = (clientX - CENTER_OFFSET_X) + "px";

        // ç¢°æ’åµæ¸¬ (ä¿æŒä¸è®Š)
        if (isColliding(element, negativityTarget) && negativityTarget.style.display !== 'none') {
            negativityTarget.classList.add('hit-ready');
            feedbackElement.textContent = "ğŸ¯ ç„æº–æˆåŠŸï¼é¬†é–‹æ‰‹æŒ‡å³å¯æ“Šç¢ï¼"; // æç¤ºè©ä¹Ÿæ”¹æˆé€šç”¨çš„
        } else {
            negativityTarget.classList.remove('hit-ready');
            feedbackElement.textContent = "ğŸš¨ å¤–ç•Œè²¶ä½å£“åŠ›å€ ğŸš¨";
        }
    }

    // çµ±ä¸€çš„çµæŸæ‹–æ›³è™•ç†å‡½æ•¸
    function closeDragElement(e) {
        // è§£é™¤äº‹ä»¶ç¶å®š
        document.onmouseup = null;
        document.onmousemove = null;
        document.removeEventListener('touchmove', elementDrag);
        document.removeEventListener('touchend', closeDragElement);
        
        // ç§»é™¤æ‹–æ›³ç‹€æ…‹é¡åˆ¥
        element.classList.remove('dragging');

        if (isColliding(element, negativityTarget) && negativityTarget.style.display !== 'none') {
            detonate(element, negativityTarget);
        } else {
            // å¦‚æœæ²’æœ‰æ“Šä¸­ï¼Œå°‡å…¶å¾ DOM ç§»é™¤
            element.remove(); 
            feedbackElement.textContent = "âš ï¸ æ“Šç¢å¤±æ•—ï¼Œè«‹é‡æ–°å˜—è©¦ï¼";
            negativityTarget.classList.remove('hit-ready');
            
            // æª¢æŸ¥å½ˆè—¥åº«æ˜¯å¦æ¸…ç©º
            if (ammoContainer.children.length === 0) {
                placeholderText.style.display = 'block';
            }
        }
    }
}
        // ----------------------------------------------------
        // æ ¸å¿ƒé‚è¼¯ä¸‰ï¼šç¢°æ’åµæ¸¬ã€çˆ†ç‚¸å‹•ç•«èˆ‡éš¨æ©Ÿè¼‰å…¥ (ä¿®æ”¹ç‚ºæ–‡å­—)
        // ----------------------------------------------------

        function isColliding(a, b) {
            const aRect = a.getBoundingClientRect();
            const bRect = b.getBoundingClientRect();
            
            return !(
                aRect.bottom < bRect.top ||
                aRect.top > bRect.bottom ||
                aRect.right < bRect.left ||
                aRect.left > bRect.right
            );
        }

        /**
         * è™•ç†çˆ†ç‚¸å‹•ç•«å’Œç§»é™¤å…ƒç´ 
         */
        function detonate(bomb, target) {
            const effort = bomb.getAttribute('data-effort');
            const subject = bomb.getAttribute('data-subject');
            
            // 1. å•Ÿå‹•ç¢è£‚å‹•ç•« (ç›´æ¥å°ç›®æ¨™å®¹å™¨)
            target.classList.add('detonate-animation');  
            bomb.remove(); // ç‚¸å½ˆç«‹åˆ»æ¶ˆå¤±

            // 2. æ­£å‘è‚¯å®šèª
            feedbackElement.textContent = `ğŸ’¥ æˆåŠŸæ“Šç¢ï¼ä½ çš„ ${subject.toUpperCase()} åŠªåŠ›ï¼šã€Œ${effort}ã€ä»–çš„çš„å°è±¡ï¼`;

            // 3. ç­‰å¾…å‹•ç•«å®Œæˆ (0.5ç§’) å¾Œï¼Œç§»é™¤å‹•ç•«é¡åˆ¥ä¸¦è¼‰å…¥æ–°ç›®æ¨™
            setTimeout(() => {
                target.classList.remove('detonate-animation');
                loadRandomTarget(); // è¼‰å…¥æ–°çš„éš¨æ©Ÿç›®æ¨™
                negativityTarget.classList.remove('hit-ready');
            }, 1000); 
            
            // æª¢æŸ¥å½ˆè—¥åº«æ˜¯å¦æ¸…ç©º
            if (ammoContainer.children.length === 0) {
                placeholderText.style.display = 'block';
            }
        }

        /**
         * è¼‰å…¥ä¸€å€‹éš¨æ©Ÿçš„è²¶ä½æ–‡å­—ç›®æ¨™
         */
        function loadRandomTarget() {
            // éš¨æ©Ÿé¸å–æ–‡å­—
            const randomIndex = Math.floor(Math.random() * negativeTargetTexts.length);
            const randomText = negativeTargetTexts[randomIndex];
            
            // æ¸…ç©ºèˆŠå…§å®¹ä¸¦åŠ å…¥æ–°æ–‡å­—
            negativityTarget.textContent = randomText;
            
            // æ›´æ–°ç‹€æ…‹æç¤º
            feedbackElement.textContent = "ğŸš¨ å£å£è¨å­ç‹å…«è›‹ ğŸš¨";
        }

        // é é¢åˆå§‹åŒ–ï¼šè¼‰å…¥ç¬¬ä¸€å€‹éš¨æ©Ÿç›®æ¨™
        document.addEventListener('DOMContentLoaded', loadRandomTarget);
    </script>
</body>
</html>

